---
description: BDDとTDDのRGBサイクルを指示
---

# BDD + RGBC TDD 開発フロー

## 概要
このコマンドは、Claude Code を用いて、振る舞い駆動開発（BDD: Behavior-Driven Development）と、テスト駆動開発の Red-Green-Blue-Commit（RGBC）サイクルを組み合わせた構造的な開発アプローチを可能にします。

## コマンド使用方法
```
/tdd
```

## 開発フロー

### 1. 📄 既存コード・ドキュメントの調査
- 既存コードベースの構造を分析
- 関連するドキュメントを確認
- 統合ポイントを特定
- 現在のパターンや規約を理解

### 2. 🎯 対話的な BDD シナリオ作成
- 会話を通して機能要件を定義
- Gherkin スタイルのシナリオを作成:
  ```gherkin
  Feature: [機能名]
    As a [役割]
    I want [機能]
    So that [利点]
    
    Scenario: [シナリオ名]
      Given [初期状態]
      When [行動]
      Then [期待される結果]
  ```
- 受け入れ基準を共同で作成
- フィードバックに基づきシナリオを改善

### 3. 🔄 RGBC サイクル（繰り返し）

#### 3.1 🔴 テスト作成（Red フェーズ）
- 失敗する最小限のテストを書く
- 1つの特定の振る舞いに集中
- 要件を明確に表現したテストにする
- テストが失敗することを確認

#### 3.2 🟢 コード実装（Green フェーズ）
- 最小限の本番コードを書く
- テストを通すことだけに集中
- 過剰な設計を避ける
- テストが通ることを確認

#### 3.3 🔵 細かくコミット（Blue フェーズ）
- テストがグリーンのままリファクタリング
- コードの品質と可読性を向上
- 重複を削除
- 意味のある小さなコミットを、明確なメッセージで行う

### 4. 📋 ドキュメント生成
- API ドキュメントを更新
- README セクションの作成・更新
- アーキテクチャ上の意思決定を記録
- 使用例を作成
- Changelog を更新

## ワークフロー手順

1. **初期設定**
    - 実装する機能について質問
    - 関連ファイルやドキュメントの特定
    - 使用するテストフレームワークを把握

2. **BDD シナリオ開発**
    - BDD シナリオを共同で作成
    - 要件に合致するか確認
    - テスト可能な単位に分割

3. **RGBC 実装ループ**
    - 各シナリオごとに:
        - RED: 失敗するテストを作成
        - GREEN: 最小限のコードを実装
        - BLUE: リファクタリングとコミット
    - 全シナリオが通るまで続ける

4. **ドキュメント**
    - 包括的なドキュメントを生成
    - 必要に応じ既存ドキュメントを更新
    - 使用例やガイドを作成

## ベストプラクティス

- **小さなステップ**: 各サイクルは小さく集中
- **明確なコミット**: 1コミットは1つの論理的変更
- **テストファースト**: 実装前にテストを書く
- **安心してリファクタリング**: テストがあるから安全
- **随時ドキュメント更新**: 機能追加ごとに更新

## セッション例

```
User: /tdd
Claude: BDD と RGBC サイクルで機能実装を手伝います。どの機能から始めますか？

User: ユーザー認証機能を追加したい
Claude: では既存コード構造の把握と BDD シナリオ作成から始めましょう…

[対話的に開発が進行]
```

## 設定オプション

ワークフローは以下を指定してカスタマイズ可能:
- テストフレームワーク（Jest, Mocha, pytest など）
- ドキュメント形式（Markdown, JSDoc など）
- コミットメッセージ形式
- コードスタイル設定

## 利点

- ✅ BDD による明確な要件定義
- ✅ 高いテストカバレッジ
- ✅ クリーンでリファクタリングされたコード
- ✅ 小さく追跡可能なコミット
- ✅ 常に最新のドキュメント
- ✅ バグ・リグレッションの減少

### 効果的な BDD シナリオ開発
- **問題から始める**: 「なぜこの機能が必要か」から始めると実装の方向性が明確になる
- **反復的な改善**: 会話を通じて段階的に詳細化し、要件漏れを防ぐ
- **シナリオ粒度**: 1シナリオは1つの振る舞いに集中する

### RGBC サイクルの知見
- **RED フェーズ**:
  - 振る舞いを明確に表現した失敗テストを書く
  - 失敗を確認してテストの正しさを検証
- **GREEN フェーズ**:
  - 最小限の実装で過剰設計を防ぐ
  - テスト通過だけに集中し、リファクタは後回し
- **BLUE フェーズ**:
  - グリーンの状態で安全にリファクタ
  - ビジネスロジックの適切な配置を検討（Service vs Model）
  - コミットメッセージは「なぜ」を説明

### プロセス改善
- **Todo 管理**: TodoWrite ツールで進捗を可視化
- **段階的ドキュメント更新**: 実装と同時に更新
- **継続的な検証**: 各変更後にテスト実行
- **コミット承認**: コミット前に承認を得て意図を共有

### 避けるべきアンチパターン
- **ビッグバン実装**: 一度に多機能を実装すると問題切り分けが困難
- **RED フェーズ省略**: 実装依存のテストになってしまう
- **遅延コミット**: まとめてコミットすると原因特定が困難