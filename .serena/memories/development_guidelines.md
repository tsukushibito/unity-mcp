# Unity MCP Server - 開発ガイドライン

## 基本方針
- **MVP重視**: 最小限の機能で素早く動作するものを優先
- **高速フィードバックループ**: 単一リポジトリアプローチで開発効率を最大化
- **将来拡張対応**: ワークスペース化を想定した設計

## アーキテクチャパターン

### Rust Server
- **rmcp SDK** を活用した MCP プロトコル実装
- **stdio/WebSocket** の複数トランスポート対応
- **非同期処理** による高いパフォーマンス

### Unity Bridge
- **Editor 統合優先**: Runtime よりも Editor での使いやすさを重視
- **UPM パッケージ化**: 再利用性を考慮した設計

## 設計パターン

### エラーハンドリング戦略
- **Result型の積極活用**: Rust のエラーハンドリングベストプラクティス
- **Context情報の付与**: anyhow による詳細なエラー情報
- **パニック回避**: 本番環境でのunwrap/expect使用禁止

### モジュール構成
```
server/src/
├── main.rs           # エントリーポイント
├── unity.rs          # Unity 固有のハンドラー
└── handlers/         # 機能別ハンドラー（将来拡張）
```

## 開発プロセス

### 作業指示対応
- **確証がない場合**: 作業を進めずに必ず質問すること
- **段階的実装**: 動作確認しながら段階的に機能を実装

### テスト戦略
- **決定論的テスト**: ネットワーク依存を避け、予測可能な結果を保証
- **モジュール内テスト**: cfg(test) による単体テスト
- **統合テスト**: server/tests/ での統合テスト

### CI/CD 活用
- **自動品質チェック**: fmt, clippy, build, test の自動実行
- **早期失敗**: 問題を早期に発見し、開発効率を向上

## コミュニケーション

### 対話言語
- **日本語での回答**: 技術的な説明も日本語で行う
- **英語コミット**: Conventional Commits 形式の英語コミットメッセージ

### ドキュメント管理
- **日本語ドキュメント**: docs/ 配下に日本語での詳細説明
- **英語 README**: プロジェクトの基本情報は英語

## 拡張パス

### スケールアウト戦略
1. **初期**: 単一クレート構成（現在）
2. **成長期**: workspace 化による core/transport-* 分割
3. **成熟期**: 複数リポジトリによる独立した開発サイクル

### Unity 側拡張
- **UPM パッケージ化済み**: 他プロジェクトへの簡単な導入
- **Editor/Runtime 分離**: 必要に応じてランタイム機能を拡張