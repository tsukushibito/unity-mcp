# Task 003: RustでベーシックgRPCサーバーサービススタブを実装

## 説明

生成されたプロトコルバッファコードを使用してRustでの初期gRPCサーバー実装を作成します。これには、UnityMcpServiceトレイトの実装、基本的なメソッドスタブの設定、既存のRustプロジェクトアーキテクチャ内でのgRPCサーバーインフラストラクチャの構築が含まれます。

## 受け入れ基準

- [ ] gRPCモジュール組織化のための`server/src/grpc/mod.rs`を作成
- [ ] UnityMcpServiceを実装する`server/src/grpc/service.rs`を作成
- [ ] 基本的なレスポンスを持つすべてのRPCメソッドスタブを実装
- [ ] gRPCサーバーの起動と設定を追加
- [ ] 既存のtracing/loggingインフラストラクチャと統合
- [ ] gRPC操作用の基本的なエラーハンドリングを作成
- [ ] サーバーが起動し、接続を受け入れることを検証
- [ ] grpcurlまたは類似ツールで基本的な接続性をテスト

## 実装ノート

**モジュール構造:**
```
server/src/grpc/
├── mod.rs          # モジュールのエクスポートとパブリックインターフェース
├── service.rs      # UnityMcpService実装
└── server.rs       # gRPCサーバーのセットアップと設定
```

**サービス実装:**
- プロトコルバッファで定義されたすべてのRPCメソッドを実装
- 初期段階では適切なデフォルト/スタブレスポンスを返す
- Tonicでの適切なasync/awaitパターンを使用
- 可能であれば既存のUnity構造体と統合
- 各RPC呼び出しに対して構造化ログを追加

**技術的考慮事項:**
- 既存のプロジェクトパターン（tracing、エラーハンドリング）に従う
- サービスメソッドでのエラーハンドリングにanyhowを使用
- 既存のstdioトランスポートと並行してgRPCサーバーを実行するよう設定
- ポート設定とバインディングオプションを考慮
- 既存のコードスタイルとの一貫性を維持

## 作成/変更するファイル

- `server/src/grpc/mod.rs` - gRPCモジュール定義
- `server/src/grpc/service.rs` - サービストレイト実装
- `server/src/grpc/server.rs` - gRPCサーバー設定
- `server/src/main.rs` - gRPCサーバー起動を統合
- `server/src/lib.rs` - 必要に応じてモジュール宣言

## テスト要件

- サーバーがエラーなく起動する
- gRPCリフレクションが動作する（テストツール用）
- grpcurlでの基本的な接続性テスト
- すべてのRPCメソッドが有効なスタブレスポンスを返す
- 無効なリクエストに対する適切なエラーレスポンス
- ログ出力にRPC呼び出しトレースが表示される
- サービスメソッドでのパニックやunwrap失敗がない

## 依存関係

- **必要:** Task 001 (プロトコルバッファサービス定義)
- **必要:** Task 002 (Rust gRPCサーバー依存関係)

## ブロック

- Task 006: 既存のMCPサーバーにgRPCトランスポートを追加
- Task 007: 双方向ストリーミングを実装
- Task 009: 統合テストを作成

## 実装優先度

**高優先度** - Unity bridgeコミュニケーションに必要なコアgRPCサーバー機能。