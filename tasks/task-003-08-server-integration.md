# Task 3.8: gRPCサーバー統合とmain.rs更新

## 説明

実装されたgRPCサービスを既存のMCPサーバーと統合し、stdioトランスポートとgRPCサーバーを並行して実行できるようにmain.rsを更新します。

## 受け入れ基準

- [ ] `main.rs`でstdioとgRPCサーバーの並行起動
- [ ] gRPCサーバーの適切な設定（ポート、リフレクション等）
- [ ] 両サーバーのライフサイクル管理
- [ ] 統一されたログ出力とエラーハンドリング
- [ ] graceful shutdownの実装
- [ ] 設定値の管理（ポート等）

## 実装内容

**main.rs修正:**
1. **サーバー並行起動**
   - tokio::spawn()を使用してgRPCサーバーを別タスクで起動
   - 既存のstdio MCPサーバーと並行実行
   - 両方のサーバーの待機処理

2. **gRPCサーバー設定**
   - UnityMcpServiceの登録
   - リフレクション機能の有効化（開発/テスト用）
   - ポート設定（デフォルト: 50051）
   - 適切なバインドアドレス設定

3. **エラーハンドリング**
   - 各サーバー起動時のエラー処理
   - ポート競合の検出と報告
   - 起動失敗時の適切な終了処理

4. **ログ統合**
   - 両サーバーの統一されたログ形式
   - 起動/停止のログ出力
   - エラー時の詳細ログ

## 技術的考慮事項

- tokioランタイムでの並行処理
- Signal handlingによるgraceful shutdown
- リソース競合の回避
- 既存のUnity MCPサーバー実装への影響最小化
- 将来の設定管理システムへの準備

## 依存関係

- **前提条件:** Task 3.7完了（全gRPCサービス実装完了）

## ブロック対象

- Task 3.9: 基本的な接続テストと検証

## 検証方法

- 両サーバーが同時に起動する
- stdioでのMCP通信が継続して動作する  
- gRPCサーバーが指定ポートでリッスンする
- ログ出力が適切に行われる
- Ctrl+Cでの正常終了
- エラー時の適切な処理

## 実装の重要度

**最高優先度** - 全機能の統合と動作確認に必要

## 実装優先度

**最高優先度** - プロジェクト全体の動作に直接影響